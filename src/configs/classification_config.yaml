name: "llm_classifier"

model:
  pretrained_checkpoint: "/data/scratch/qc25022/pancreas/experiments/Pretrain-Qwen3-8B-Pancreas-Raw/checkpoint-19640"
  max_length: 12000           # Used when loading model 
  hidden_size: 4096
  num_labels: 2
  freeze_llm: true            # Keep base model frozen, only LoRA + classifier train
  train_lora: true            # Re-enable LoRA adapter parameters for training
  
  # Classification head architecture
  head_type: "linear"         # Options: "linear", "mlp", "deep_mlp"
  head_hidden_size: 512       # Hidden layer size for MLP heads (ignored for linear)
  head_dropout: 0.1           # Dropout rate for MLP heads (ignored for linear)

wandb:
  enabled: true
  project: "Pretrain-Qwen3-8B-Pancreas-classification-logisitc"
  run_name: "lora-6-month-logistic-raw"

training:
  output_dir: "/data/scratch/qc25022/pancreas/experiments/lora-6-month-logistic-raw"
  overwrite_output_dir: true
  epochs: 1
  batch_size: 2
  eval_batch_size: 1
  learning_rate: 1e-6
  weight_decay: 0.01
  warmup_steps: 100
  gradient_accumulation_steps: 2
  fp16: false
  bf16: true
  logging_steps: 50
  eval_steps: 250
  save_steps: 500
  save_total_limit: 2
  load_in_4bit: true
  multi_label: false
  # early_stopping_patience: 5
  # early_stopping_threshold: 0.001
  dataloader_num_workers: 8


data:
  cutoff_months: 6
  data_dir: "/data/scratch/qc25022/pancreas/tokenised_data_word_level/cprd_upgi/"
  vocab_filepath: "/data/scratch/qc25022/pancreas/tokenised_data_word_level/cprd_upgi/vocab.csv"
  labels_filepath: "/data/scratch/qc25022/upgi/master_subject_labels.csv"
  medical_lookup_filepath: "/data/home/qc25022/CancEHR-Training/src/resources/MedicalDictTranslation2.csv"
  lab_lookup_filepath: "/data/home/qc25022/CancEHR-Training/src/resources/LabLookUP.csv"
  region_lookup_filepath: "/data/home/qc25022/CancEHR-Training/src/resources/RegionLookUp.csv"
  time_lookup_filepath: "/data/home/qc25022/CancEHR-Training/src/resources/TimeLookUp.csv"
  max_length: 12000           # Used by collator for truncation
  handle_long_sequences: "warn"
  sort_by_length: true
